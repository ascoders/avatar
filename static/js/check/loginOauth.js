"use strict";define("checkOauth",["jquery","frontia"],function(e,a){return console.log(a),avalon.define({$id:"checkOauth",img:"",nickname:"",onChange:function(){var n="RqeMWD9G1m8agmxfj6ngCKRG";a.init(n),a.social.setLoginCallback({success:function(a){post("/api/check/hasOauth",{id:a.getId(),token:a.getAccessToken(),type:a.getMediaType(),expire:a.getExpiresIn()},"","",function(n){-1==n?e.ajax({url:"https://openapi.baidu.com/social/api/2.0/user/info",type:"POST",dataType:"jsonp",jsonp:"callback",data:{access_token:a.getAccessToken()}}).done(function(e){avalon.vmodels.checkOauth.img=e.headurl,avalon.vmodels.checkOauth.nickname=e.username}):(n.image=userImage(n.image),avalon.vmodels.global.my=n,avalon.vmodels.global.myLogin=!0,avalon.router.navigate(avalon.router.getLastPath()))})},error:function(){showAlert("验证失败",!1),location.href="/"}})},onAfterLoad:function(){},submit:function(){return avalon.vmodels.checkOauth.nickname.length<3||avalon.vmodels.checkOauth.nickname.length>20?(notice("昵称长度为3-20","red"),!1):void post("/api/check/oauthRegister",{id:user.getId(),token:user.getAccessToken(),nickname:result.username,nowname:e("#j-nickname").val(),image:result.headurl,type:user.getMediaType(),expire:user.getExpiresIn()},"注册成功","",function(e){e.image=userImage(e.image),avalon.vmodels.global.my=e,avalon.vmodels.global.myLogin=!0,avalon.router.navigate(avalon.router.getLastPath())})},$skipArray:["onChange","onAfterLoad"]})});